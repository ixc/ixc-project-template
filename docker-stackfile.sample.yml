# Update and save as `docker-stackfile.{environment}.yml`. Do not commit secrets.
django:
  # autoredeploy: true
  deployment_strategy: high_availability
  environment:
    BASE_SETTINGS_MODULE: develop
    # EMAIL_HOST:
    # EMAIL_HOST_USER:
    # EMAIL_HOST_PASSWORD:
    # MASTER_PASSWORD:
    # PGDATABASE: {{ project_name }}
    # PGHOST:
    PGPASSWORD:
    # PGPORT:
    # PGUSER:
    # SRC_PGHOST:
    # SRC_PGPASSWORD:
    # SRC_PGPORT:
    # SRC_PGUSER:
  image: interaction/{{ project_name }}:latest
  links:
    # - elasticsearch
    - postgres
    - redis
  ports:
    - "8000"
  restart: on-failure
  # sequential_deployment: true
  volumes:
    - /opt/{{ project_name }}/var
# elasticsearch:
#   image: interaction/elasticsearch-icu:1
#   restart: on-failure
haproxy:
  image: dockercloud/haproxy:1.2
  links:
    - django
  ports:
    - "80"
  roles:
    - global
  restart: on-failure
postgres:
  environment:
    POSTGRES_PASSWORD:
  image: postgres:9.4
  restart: on-failure
redis:
  image: redis:3
  restart: on-failure
